{"version":3,"file":"utm-aska.min.js","sources":["../src/get/getUtmParams.js"],"sourcesContent":["export default function getUtmParams() {\r\n    const utmKeysMap = [\r\n        'utm_source',\r\n        'utm_medium',\r\n        'utm_campaign',\r\n        'utm_term',\r\n        'utm_content',\r\n    ]\r\n\r\n    // Объект с полученными utm-метками\r\n    let utmParamsObject\r\n\r\n    // Получение utm-меток из GET параметров\r\n    function getAllUrlParams(url) {\r\n        let queryString = url\r\n            ? url.split('?')[1]\r\n            : window.location.search.slice(1)\r\n        const obj = {}\r\n\r\n        if (queryString) {\r\n            queryString = queryString.split('#')[0]\r\n            const arr = queryString.split('&')\r\n\r\n            for (let i = 0; i < arr.length; i++) {\r\n                const a = arr[i].split('=')\r\n                let paramName = a[0]\r\n                if (utmKeysMap.includes(paramName)) {\r\n                    let paramValue = typeof a[1] === 'undefined' ? true : a[1]\r\n\r\n                    paramName = paramName.toLowerCase()\r\n                    if (typeof paramValue === 'string')\r\n                        paramValue = paramValue.toLowerCase()\r\n\r\n                    if (paramName.match(/\\[(\\d+)?]$/)) {\r\n                        const key = paramName.replace(/\\[(\\d+)?]/, '')\r\n                        if (!obj[key]) obj[key] = []\r\n\r\n                        if (paramName.match(/\\[\\d+]$/)) {\r\n                            const index = /\\[(\\d+)]/.exec(paramName)[1]\r\n                            obj[key][index] = paramValue\r\n                        } else {\r\n                            obj[key].push(paramValue)\r\n                        }\r\n                    } else if (!obj[paramName]) {\r\n                        obj[paramName] = paramValue\r\n                    } else if (obj[paramName] && typeof obj[paramName] === 'string') {\r\n                        obj[paramName] = [obj[paramName]]\r\n                        obj[paramName].push(paramValue)\r\n                    } else {\r\n                        obj[paramName].push(paramValue)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return obj\r\n    }\r\n\r\n    // Получение utm-меток по ключу из cookies\r\n    function getAllUtmCookies() {\r\n        return document.cookie.split(';').reduce((cookies, cookie) => {\r\n            const [name, val] = cookie.split('=').map((c) => c.trim())\r\n            if (utmKeysMap.includes(name)) {\r\n                cookies[name] = val\r\n            }\r\n            return cookies\r\n        }, {})\r\n    }\r\n\r\n    // Получение куки по имени\r\n    function getCookieByName(name) {\r\n        const value = `; ${document.cookie}`\r\n        const parts = value.split(`; ${name}=`)\r\n        if (parts.length === 2)\r\n            return JSON.parse(decodeURIComponent(parts.pop().split(';').shift()))\r\n    }\r\n\r\n    // Получаем все utm метки из урла страницы\r\n    utmParamsObject = getAllUrlParams(window.location.href)\r\n\r\n    if (utmParamsObject && Object.keys(utmParamsObject).length === 0) {\r\n        // Если в урле нет меток, то получаем их из куки по ключам\r\n        utmParamsObject = getAllUtmCookies()\r\n        if (Object.keys(utmParamsObject).length === 0) {\r\n            // Если в куках по ключам нет меток, то получаем их из куки utm\r\n            utmParamsObject = getCookieByName('utm')\r\n        }\r\n    }\r\n\r\n    return utmParamsObject\r\n}"],"names":["utmParamsObject","utmKeysMap","url","queryString","split","window","location","search","slice","obj","arr","i","length","a","paramName","includes","paramValue","toLowerCase","match","key","replace","index","exec","push","getAllUrlParams","href","Object","keys","document","cookie","reduce","cookies","map","c","trim","name","val","parts","JSON","parse","decodeURIComponent","pop","shift","getCookieByName"],"mappings":"8sCAAe,eAUPA,EATEC,EAAa,CACf,aACA,aACA,eACA,WACA,sBAwEJD,WAjEyBE,OACjBC,EAAcD,EACZA,EAAIE,MAAM,KAAK,GACfC,OAAOC,SAASC,OAAOC,MAAM,GAC7BC,EAAM,MAERN,UAEMO,GADNP,EAAcA,EAAYC,MAAM,KAAK,IACbA,MAAM,KAErBO,EAAI,EAAGA,EAAID,EAAIE,OAAQD,IAAK,KAC3BE,EAAIH,EAAIC,GAAGP,MAAM,KACnBU,EAAYD,EAAE,MACdZ,EAAWc,SAASD,GAAY,KAC5BE,OAA6B,IAATH,EAAE,IAA4BA,EAAE,MAExDC,EAAYA,EAAUG,cACI,iBAAfD,IACPA,EAAaA,EAAWC,eAExBH,EAAUI,MAAM,cAAe,KACzBC,EAAML,EAAUM,QAAQ,YAAa,OACtCX,EAAIU,KAAMV,EAAIU,GAAO,IAEtBL,EAAUI,MAAM,WAAY,KACtBG,EAAQ,WAAWC,KAAKR,GAAW,GACzCL,EAAIU,GAAKE,GAASL,OAElBP,EAAIU,GAAKI,KAAKP,QAEVP,EAAIK,GAELL,EAAIK,IAAwC,iBAAnBL,EAAIK,IACpCL,EAAIK,GAAa,CAACL,EAAIK,IACtBL,EAAIK,GAAWS,KAAKP,IAEpBP,EAAIK,GAAWS,KAAKP,GALpBP,EAAIK,GAAaE,UAW1BP,EAuBOe,CAAgBnB,OAAOC,SAASmB,QAEa,IAAxCC,OAAOC,KAAK3B,GAAiBY,SAEhDZ,EAtBO4B,SAASC,OAAOzB,MAAM,KAAK0B,QAAO,SAACC,EAASF,WAC3BA,EAAOzB,MAAM,KAAK4B,KAAI,SAACC,UAAMA,EAAEC,aAA5CC,OAAMC,cACTnC,EAAWc,SAASoB,KACpBJ,EAAQI,GAAQC,GAEbL,IACR,IAiByC,IAAxCL,OAAOC,KAAK3B,GAAiBY,SAE7BZ,WAfiBmC,OAEfE,cADaT,SAASC,QACRzB,kBAAW+B,WACV,IAAjBE,EAAMzB,OACN,OAAO0B,KAAKC,MAAMC,mBAAmBH,EAAMI,MAAMrC,MAAM,KAAKsC,UAW1CC,CAAgB,SAInC3C"}